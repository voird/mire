
:- dynamic игрок/3.% Локации на карте
локация(город).
локация(работа).
локация(кафе).
локация(парк).




% Задачи для подработки
задача(работа, подработка_1, 50). % подработка_1 приносит 50 монет
задача(работа, подработка_2, 30). % подработка_2 приносит 30 монет
задача(кафе, подработка_3, 20).   % подработка_3 приносит 20 монет

% Статус игрока
игрок(игрок1, город, 0). % игрок1 находится в городе, имеет 0 монет

% Перемещение по направлениям
перемещение(Игрок, Направление) :-
    игрок(Игрок, Текущая_Локация, Монеты),
    (   Направление = север, север(Текущая_Локация, Новая_Локация);
        Направление = юг, юг(Текущая_Локация, Новая_Локация);
        Направление = восток, восток(Текущая_Локация, Новая_Локация);
        Направление = запад, запад(Текущая_Локация, Новая_Локация)
    ),
    retract(игрок(Игрок, Текущая_Локация, Монеты)),
    assert(игрок(Игрок, Новая_Локация, Монеты)),
    write(Игрок), write(' перемещается на '), write(Направление), write(' в '), write(Новая_Локация), nl.

% Пример перемещения игрока
перемещение_игрока :-
    перемещение(игрок1, север).


% Выполнение подработки
выполнить_подработку(Игрок, Локация, Подработка) :-
    задача(Локация, Подработка, Сумма),
    игрок(Игрок, Локация, Монеты),
    Новый_Баланс is Монеты + Сумма,
    retract(игрок(Игрок, Локация, Монеты)),
    assert(игрок(Игрок, Локация, Новый_Баланс)),
    write(Игрок), write(' выполнил задачу: '), write(Подработка), write(', заработав '), write(Сумма), write(' монет. Баланс: '), write(Новый_Баланс), nl.

% Связи по направлениям
север(город, парк).         % север от города — парк
юг(город, работа).          % юг от города — работа
восток(город, кафе).        % восток от города — кафе
запад(работа, парк).        % запад от работы — парк
запад(кафе, работа).        % запад от кафе — работа
восток(парк, город).        % восток от парка — город
юг(кафе, парк).             % юг от кафе — парк


% Пример выполнения подработки
выполнить_подработку_игрока :-
    выполнить_подработку(игрок1, работа, подработка_1).

% Выполнение подработки
выполнить_подработку(Игрок, Локация, Подработка) :-
    задача(Локация, Подработка, Сумма),
    игрок(Игрок, Локация, Монеты),
    Новый_Баланс is Монеты + Сумма,
    retract(игрок(Игрок, Локация, Монеты)),
    assert(игрок(Игрок, Локация, Новый_Баланс)),
    write(Игрок), write(' выполнил задачу: '), write(Подработка), write(', заработав '), write(Сумма), write(' монет. Баланс: '), write(Новый_Баланс), nl.

% Пример выполнения подработки
выполнить_подработку_игрока :-
    выполнить_подработку(игрок1, работа, подработка_1).

% Сюжет
сюжет(игрок1, "Ты только что приехал в город и ищешь подработку. Твоя первая задача — найти работу в кафе и заработать немного денег.").

% Выполнение задания по сюжету
выполнение_задания :-
    сюжет(игрок1, Задание),
    write(Задание), nl,
    выполнить_подработку(игрок1, кафе, подработка_3).

% Новый этап сюжета после выполнения задачи
новая_подработка :-
    игрок(игрок1, кафе, Баланс),
    Баланс >= 50, % если игрок заработал достаточно денег
    write('Ты заработал достаточно, теперь можешь взять более сложную работу!'), nl,
    задача(работа, подработка_2, 30), % новая задача
    выполнить_подработку(игрок1, работа, подработка_2).
